{
  "Order": 3,
  "Title": "Localization",
  "Html": "<p>The localization of this site is through <code>AntDesign.Extensions.Localization</code> libraries to achieve, mainly provide interactive localization services.\nIt can integrate with official or third-party localization providers to switch languages at runtime without forced reload. In addition, it includes a simple embedded JSON provider.</p>\n<h2>Installation</h2>\n<pre><code class=\"language-shell\">dotnet add package AntDesign.Extensions.Localization\n</code></pre>\n<h3>Use interactive localization service</h3>\n<ul>\n<li><p>Add the following code to the 'Program.cs' file:</p>\n<pre><code class=\"language-csharp\">builder.Services.AddInteractiveStringLocalizer();\nbuilder.Services.AddLocalization(options =&gt;\n{\n    options.ResourcesPath = &quot;Resources&quot;;\n});\n\n</code></pre>\n</li>\n<li><p>Create resource files in the <code>Resources</code> directory of the project in the format <code>{ResourceName}.{language}.resx</code>, for example <code>Index.en-US.resx</code> and <code>index.en-cn.resx</code>.</p>\n<p>Index.en-US.resx:</p>\n<table>\n<thead>\n<tr>\n<th>key</th>\n<th>value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Hello</td>\n<td>Hello!</td>\n</tr>\n<tr>\n<td>Goodbye</td>\n<td>Goodbye!</td>\n</tr>\n</tbody>\n</table>\n<p>Index.zh-CN.resx:</p>\n<table>\n<thead>\n<tr>\n<th>key</th>\n<th>value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Hello</td>\n<td>Hello!</td>\n</tr>\n<tr>\n<td>Goodbye</td>\n<td>Goodbye!</td>\n</tr>\n</tbody>\n</table>\n</li>\n</ul>\n<p>It should be noted that, <code>IStringLocalizer&lt;T&gt;</code>  needs to specify a generic type parameter as the positioning of the resx file, so you need to ensure that the resource file has a corresponding public type.\nOr manually modify the csproj file as follows:</p>\n<pre><code class=\"language-xml\">  &lt;ItemGroup&gt;\n    &lt;Compile Update=&quot;Resources\\Resources.Designer.cs&quot;&gt;\n      &lt;DesignTime&gt;True&lt;/DesignTime&gt;\n      &lt;AutoGen&gt;True&lt;/AutoGen&gt;\n      &lt;DependentUpon&gt;Resources.resx&lt;/DependentUpon&gt;\n    &lt;/Compile&gt;\n  &lt;/ItemGroup&gt;\n\n  &lt;ItemGroup&gt;\n    &lt;EmbeddedResource Update=&quot;Resources\\Resources.resx&quot;&gt;\n      &lt;Generator&gt;PublicResXFileCodeGenerator&lt;/Generator&gt;\n      &lt;LastGenOutput&gt;Resources.Designer.cs&lt;/LastGenOutput&gt;\n    &lt;/EmbeddedResource&gt;\n  &lt;/ItemGroup&gt;\n</code></pre>\n<ul>\n<li><p>When in use, inject the <code>IStringLocalizer&lt;T&gt;</code> service in razor, for example:</p>\n<pre><code class=\"language-html\">@inject IStringLocalizer&lt;Index&gt; localizer\n\n&lt;p&gt;@localizer[&quot;Hello&quot;]&lt;/p&gt;\n&lt;p&gt;@localizer[&quot;Goodbye&quot;]&lt;/p&gt;\n</code></pre>\n</li>\n<li><p>Switch UI languages interactively</p>\n<pre><code class=\"language-html\">@implements IDisposable\n@inject ILocalizationService LocalizationService\n\n&lt;Button OnClick=&quot;()=&gt;LocalizationService.SetLanguage(&quot;en-US&quot;)&quot; &gt;English&lt;/Button&gt;\n&lt;Button OnClick=&quot;()=&gt;LocalizationService.SetLanguage(&quot;zh-CN&quot;)&quot; &gt;中文&lt;/Button&gt;\n\n@code {\n\n    protected override void OnInitialized()\n    {\n        LocalizationService.LanguageChanged += OnLanguageChanged;\n    }\n    private void OnLanguageChanged(object sender, CultureInfo args)\n    {\n        InvokeAsync(StateHasChanged);\n    }\n    public void Dispose()\n    {\n        LocalizationService.LanguageChanged -= OnLanguageChanged;\n    }\n}\n</code></pre>\n</li>\n<li><p>To use a third-party Localization provider, or other configurations, refer to the <a href=\"https://learn.microsoft.com/zh-cn/aspnet/core/blazor/globalization-localization?view=aspnetcore-8.0&amp;WT.mc_id=DT-MVP-5003987\">Official Documentation</a>。</p>\n</li>\n</ul>\n<h3>Localization of form validation messages</h3>\n<p>The default validator for the Form component is <a href=\"https://learn.microsoft.com/en-us/aspnet/core/blazor/forms/validation?view=aspnetcore-8.0&amp;WT.mc_id=DT-MVP-5003987#nested-models-collection-types-and-complex-types\">ObjectGraphDataAnnotationsValidator</a>, supports <a href=\"https://learn.microsoft.com/en-us/aspnet/core/fundamentals/localization/make-content-localizable?view=aspnetcore-8.0&amp;WT.mc_id=DT-MVP-5003987#dataannotations-localization\">DataAnnotations localization</a>。</p>\n<h1>Demo: <a href=\"https://antblazor.com/en-US/components/form#components-form-demo-localization\">Form-localization </a></h1>\n<p>Note: Configuration of validation information in AntDesign locales is not currently supported.</p>\n<h3>DisplayAttribute  supports localization</h3>\n<p>Some UI bindings in the component use the DisplayAttribute feature of the entity model or enumeration type as a Label display, such as FormItem, EnumSelect, EnumRadioGroup, EnumCheckboxGroup, and so on.</p>\n<pre><code class=\"language-cs\">  public class Model\n  {\n      [Display(Name = nameof(Resources.App.UserName), ResourceType = typeof(Resources.App))]\n      public string Username { get; set; }\n  }\n\n  public enum Province\n  {\n      [Display(Name = nameof(Resources.App.Shanghai), ResourceType = typeof(Resources.App))]\n      Shanghai,\n\n      Jiangsu\n  }\n</code></pre>\n<h3>Use the simple embedded JSON provider</h3>\n<p>While we recommend the official localization solution, you can also use the solution of this documentation site to implement localization with a simple embedded JSON provider. It should be noted that it only supports direct injection of IStringLocalizer, not its generics (IStringLocalizer<T>), and localization files only support a single file.</p>\n<ul>\n<li><p>In <code>Program.cs</code> file, please add the following code, this method in internal has invoked the <code>AddInteractiveStringLocalizer</code>.</p>\n<pre><code class=\"language-csharp\">builder.Services.AddSimpleEmbeddedJsonLocalization(options =&gt;\n{\n    options.ResourcesPath = &quot;Resources&quot;;\n    options.Resources = SimpleStringLocalizerOptions.BuildResources(&quot;Resources&quot;, Assembly.GetExecutingAssembly());\n});\n</code></pre>\n</li>\n<li><p>Create resource files in the 'Resources' directory of the project in the format <code>{language}.json</code>, for example <code>en-US.json</code> and <code>zh-CN.json</code>.</p>\n<pre><code class=\"language-json\">// en-US.json\n{\n    &quot;Hello&quot;: &quot;Hello!&quot;,\n    &quot;Goodbye&quot;: &quot;Goodbye!&quot;\n}\n\n// zh-CN.json\n{\n    &quot;Hello&quot;: &quot;你好!&quot;,\n    &quot;Goodbye&quot;: &quot;再见!&quot;\n}\n</code></pre>\n</li>\n<li><p>Set the build action for the JSON file, set to &quot;embedded resource&quot;</p>\n<pre><code class=\"language-xml\">  &lt;ItemGroup&gt;\n      &lt;EmbeddedResource Include=&quot;Resources\\*.json&quot; /&gt;\n  &lt;/ItemGroup&gt;\n</code></pre>\n</li>\n<li><p>Inject the <code>IStringLocalizer</code> service (without generics) in razor when used, for example:</p>\n<pre><code class=\"language-razor\">@inject IStringLocalizer localizer\n\n&lt;p&gt;@localizer[&quot;Hello&quot;]&lt;/p&gt;\n&lt;p&gt;@localizer[&quot;Goodbye&quot;]&lt;/p&gt;\n</code></pre>\n</li>\n</ul>\n<h3>Language identifier on the route</h3>\n<p>From the beginning of this site, we have implemented the language identifier of the route. It has the following features:</p>\n<ol>\n<li>When you enter the page, it can automatically add a <code>{locale}</code> parameter to the route according to the browser environment, such as <code>/en-US/Index</code>.</li>\n<li>It can also switch languages according to the existing identifier on the route, so when you want to switch languages, you only need to navigate to the path of the corresponding language.</li>\n</ol>\n<p>Here's how it works:</p>\n<ul>\n<li>First, in <code>Routes.Razor</code> file, implementation the <code>OnNavigateAsync</code> method for <code>Router</code> components, called <code>LocalizationService.SetLanguage </code> method to switch the language.</li>\n</ul>\n<pre><code class=\"language-razor\">@using System.Reflection\n@using System.Globalization\n\n&lt;ConfigProvider&gt;\n    &lt;Router AppAssembly=&quot;typeof(App).Assembly&quot; OnNavigateAsync=&quot;OnNavigateAsync&quot;&gt;\n        &lt;Found Context=&quot;routeData&quot;&gt;\n            &lt;RouteView RouteData=&quot;routeData&quot; DefaultLayout=&quot;typeof(MainLayout)&quot; /&gt;\n            &lt;FocusOnNavigate RouteData=&quot;routeData&quot; Selector=&quot;h1&quot; /&gt;\n        &lt;/Found&gt;\n        &lt;NotFound&gt;\n            &lt;Result Status=&quot;404&quot; /&gt;\n        &lt;/NotFound&gt;\n    &lt;/Router&gt;\n    &lt;AntContainer /&gt;\n&lt;/ConfigProvider&gt;\n\n@inject ILocalizationService LocalizationService;\n@inject NavigationManager NavigationManager;\n@code{\n    async Task OnNavigateAsync(NavigationContext navigationContext)\n    {\n        var relativeUri = navigationContext.Path;\n        var currentCulture = LocalizationService.CurrentCulture;\n\n        var segment = relativeUri.IndexOf('/') &gt; 0 ? relativeUri.Substring(0, relativeUri.IndexOf('/')) : relativeUri;\n\n        if (string.IsNullOrWhiteSpace(segment))\n        {\n            NavigationManager.NavigateTo($&quot;{currentCulture.Name}/{relativeUri}&quot;);\n            return;\n        }\n        else\n        {\n            if (segment.IsIn(&quot;zh-CN&quot;, &quot;en-US&quot;))\n            {\n                LocalizationService.SetLanguage(CultureInfo.GetCultureInfo(segment));\n            }\n            else if (currentCulture.Name.IsIn(&quot;zh-CN&quot;, &quot;en-US&quot;))\n            {\n                NavigationManager.NavigateTo($&quot;{currentCulture.Name}/{relativeUri}&quot;);\n            }\n            else\n            {\n                NavigationManager.NavigateTo($&quot;en-US/{relativeUri}&quot;);\n                return;\n            }\n        }\n    }\n}\n</code></pre>\n<ul>\n<li>Finally, you need to add the <code>{locale}</code> parameter to all page components, so that the switched route matches the corresponding page.</li>\n</ul>\n<pre><code class=\"language-razor\">@page &quot;/{locale}/Index&quot;\n\n@inject IStringLocalizer&lt;Index&gt; localizer\n\n&lt;p&gt;@localizer[&quot;Hello&quot;]&lt;/p&gt;\n\n@code {\n\n    [Parameter]\n    public string Locale { get; set; }\n}\n\n</code></pre>\n"
}