@namespace AntDesign.Docs.Demos.Experimental.TableRelationColumn.Demo.Shared

@typeparam TItem

@inherits RelationComponentBase<TItem, int>

@* Shared Relation Display Component - Reusable across different table types *@

@if (_userData == null)
{
    <span>Loading...</span>
}
else if (_userData.TryGetValue(CurrentFieldValue, out var data))
{
    <Space Size="@SpaceSize.Small">
        <SpaceItem>
            <Tag Color="@data.Color">@data.Name</Tag>
        </SpaceItem>
        <SpaceItem>
            <Text Type="@TextElementType.Secondary" Style="font-size: 12px">
                (@data.Description)
            </Text>
        </SpaceItem>
    </Space>
}
else
{
    <Tag Color="@("gray")">Unknown</Tag>
}

@code {
    // Simulated relation data - can be users or departments based on context
    private Dictionary<int, UserData> _userData = null;

    // Batch load relation data
    protected override async Task OnLoadBatch(IEnumerable<int> ids)
    {
        _userData = null;
        await Task.Delay(300); // Simulate async data fetch
        _userData = new()
        {
            { 1, new UserData { Name = "John Doe", Description = "john.doe@example.com", Color = "blue" } },
            { 2, new UserData { Name = "Jane Smith", Description = "jane.smith@example.com", Color = "green" } },
            { 3, new UserData { Name = "Bob Johnson", Description = "bob.johnson@example.com", Color = "orange" } },
            { 4, new UserData { Name = "Alice Brown", Description = "alice.brown@example.com", Color = "purple" } },
            { 5, new UserData { Name = "Charlie Wilson", Description = "charlie.wilson@example.com", Color = "red" } },
            { 6, new UserData { Name = "David Lee", Description = "david.lee@example.com", Color = "cyan" } }
        };

        Console.WriteLine($"[RelationDisplay<{typeof(TItem).Name}>] Batch loading IDs: {string.Join(", ", ids.Distinct())}");
    }

    private class UserData
    {
        public string Name { get; set; }
        public string Description { get; set; }
        public string Color { get; set; }
    }
}