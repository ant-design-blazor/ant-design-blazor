@using System.Threading.Tasks
@using AntDesign.Docs.Demos.Experimental.TableEnhanced.Demo.Shared
@using AntDesign.Docs.Demos.Experimental.TableRelationColumn.Demo.Shared

@* Demo: Multiple columns sharing the same loaded data *@

<h4>Orders with User Details - Multiple Columns from Single Load</h4>

<Table TItem="Order" DataSource="@orders" Size="@TableSize.Small">
    <PropertyColumn Property="c=>c.OrderId" Title="Order ID" />
    <PropertyColumn Property="c=>c.Amount" Title="Amount" Format="C2" />

    @* Multiple columns sharing the same user data load *@

    @* Column 1: User Name - displays user name from loaded data *@
    <PropertyColumn Property="c=>c.UserId" Title="User Name">
        <UserMultiFieldRelation TItem="Order" DisplayField="Name" />
    </PropertyColumn>

    @* Column 2: User Address - displays user address from the same loaded data *@
    <PropertyColumn Property="c=>c.UserId" Title="User Address">
        <UserMultiFieldRelation TItem="Order" DisplayField="Address" />
    </PropertyColumn>

    @* Column 3: User Email - displays user email from the same loaded data *@
    <PropertyColumn Property="c=>c.UserId" Title="User Email">
        <UserMultiFieldRelation TItem="Order" DisplayField="Email" />
    </PropertyColumn>

    <PropertyColumn Property="c=>c.CreatedTime" Title="Created Time" Format="yyyy-MM-dd HH:mm" />
</Table>

@code {
    private List<Order> orders = new();

    protected override void OnInitialized()
    {
        // Initialize orders data
        orders = new List<Order>
        {
            new Order { OrderId = "ORD001", UserId = 1, Amount = 299.50m, CreatedTime = DateTime.Now.AddDays(-5) },
            new Order { OrderId = "ORD002", UserId = 2, Amount = 150.00m, CreatedTime = DateTime.Now.AddDays(-4) },
            new Order { OrderId = "ORD003", UserId = 1, Amount = 450.00m, CreatedTime = DateTime.Now.AddDays(-3) },
            new Order { OrderId = "ORD004", UserId = 3, Amount = 199.99m, CreatedTime = DateTime.Now.AddDays(-2) },
            new Order { OrderId = "ORD005", UserId = 2, Amount = 350.00m, CreatedTime = DateTime.Now.AddDays(-1) },
            new Order { OrderId = "ORD006", UserId = 4, Amount = 580.00m, CreatedTime = DateTime.Now },
            new Order { OrderId = "ORD007", UserId = 1, Amount = 120.00m, CreatedTime = DateTime.Now.AddHours(-12) },
            new Order { OrderId = "ORD008", UserId = 5, Amount = 890.00m, CreatedTime = DateTime.Now.AddHours(-6) },
        };
    }

    // Order entity
    public class Order
    {
        public string OrderId { get; set; }
        public int UserId { get; set; }
        public decimal Amount { get; set; }
        public DateTime CreatedTime { get; set; }
    }
}