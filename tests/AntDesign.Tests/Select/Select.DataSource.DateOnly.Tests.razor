@using System
@inherits AntDesignTestBase
@code {
#if NET6_0_OR_GREATER
    public Select_DataSource_DateOnly_Tests()
    {
        JSInterop.Setup<AntDesign.JsInterop.DomRect>(JSInteropConstants.GetBoundingClientRect, _ => true)
               .SetResult(new AntDesign.JsInterop.DomRect());
    }

    [Fact]
    public void Select_DataSource_With_DateOnly_Should_Update_Without_DuplicateKeyException()
    {
        // Arrange
        var dataSource = new DateOnly[]
        {
            new DateOnly(2026, 1, 1),
            new DateOnly(2026, 1, 2),
            new DateOnly(2026, 1, 3)
        };

        var cut = Render<AntDesign.Select<DateOnly, DateOnly>>(
            @<AntDesign.Select TItem="DateOnly" TItemValue="DateOnly" DataSource="@dataSource">
            </AntDesign.Select>
        );

        cut.Render();

        // Act
        var newData = new DateOnly[] { new DateOnly(2026, 1, 2) };

        Action act = () => cut.SetParametersAndRender(parameters => parameters.Add(p => p.DataSource, newData));

        // Assert
        act.Should().NotThrow();
        cut.Instance.SelectOptionItems.Where(x => !x.IsHidden).Should().HaveCount(1);
    }
#endif
}